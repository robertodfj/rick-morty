# **** PRUEBAS DE POSTMAN ****

Base URL:
http://localhost:5235

--------------------------------------------------

# 1️⃣ PRUEBAS DE AUTH

## 1.1 POST /auth/register ✅

Endpoint:
POST http://localhost:5235/auth/register

Headers:
Content-Type: application/json

Body (JSON):
{
  "username": "testuser",
  "email": "testuser@gmail.com",
  "password": "1234567890",
  "confirmPassword": "1234567890"
}

Respuesta esperada (200 OK):
{
  "message": "User registered successfully"
}

Pruebas realizadas de validaciones:
{
    "type": "https://tools.ietf.org/html/rfc9110#section-15.5.1",
    "title": "One or more validation errors occurred.",
    "status": 400,
    "errors": {
        "$": [
            "JSON deserialization for type 'RickYMorty.dto.auth.RegisterDTO' was missing required properties including: 'email'; 'confirmPassword'."
        ],
        "registerDTO": [
            "The registerDTO field is required."
        ]
    },
    "traceId": "00-ceeebc3f69dd6d40d2214bb4efa1e5df-f81a9321f142fbd2-00"

}
{
    "type": "https://tools.ietf.org/html/rfc9110#section-15.5.1",
    "title": "One or more validation errors occurred.",
    "status": 400,
    "errors": {
        "Password": [
            "The field Password must be a string with a minimum length of 10 and a maximum length of 100."
        ],
        "ConfirmPassword": [
            "The field ConfirmPassword must be a string with a minimum length of 10 and a maximum length of 100."
        ]
    },
    "traceId": "00-cf781f88fffed9bf7542591d1791b6df-c1cd7ae6e807d11c-00"
}

--------------------------------------------------

## 1.2 POST /auth/login ✅

Endpoint:
POST http://localhost:5235/auth/login

Headers:
Content-Type: application/json

Body (JSON):
{
  "username": "testuser",
  "password": "123456"
}

Respuesta esperada (200 OK):
{
    "token": "eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNobWFjLXNoYTI1NiIsInR5cCI6IkpXVCJ9.eyJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1lIjoidGVzdHVzZXIiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9lbWFpbGFkZHJlc3MiOiJ0ZXN0dXNlckBnbWFpbC5jb20iLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1laWRlbnRpZmllciI6IjEiLCJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dzLzIwMDgvMDYvaWRlbnRpdHkvY2xhaW1zL3JvbGUiOiJVc2VyIiwiZXhwIjoxNzcwODEzODg4fQ._KqbBUxfIml6vk7PTCikCFPv0uIXvX1uMOIJrj48LHY"
}

⚠️ IMPORTANTE:
Copiar el token y usarlo en las siguientes peticiones protegidas.

Header para endpoints protegidos:
Authorization: Bearer TU_TOKEN_AQUI

--------------------------------------------------

## 1.3 POST /auth/register-admin ✅

⚠️ Requiere rol Admin

Endpoint:
POST http://localhost:5235/auth/register-admin

Headers:
Content-Type: application/json
Authorization: Bearer TU_TOKEN_ADMIN

Body (JSON):
{
  "username": "admin2",
  "password": "123456"
}

Respuesta esperada (200 OK):
{
  "message": "Admin registered successfully"
}

Prueba de validacion:
401 Unauthorized
{
    "message": "Authentication token is missing or invalid"
}

# 2️⃣ PRUEBAS DE CHARACTER

Header común para endpoints protegidos:

Authorization: Bearer TU_TOKEN_AQUI
Content-Type: application/json


⸻

2.1 POST /characters/capture ✅

Endpoint:
POST http://localhost:5235/characters/capture

Headers:
Content-Type: application/json
Authorization: Bearer TU_TOKEN_AQUI

Body (JSON):

{
  "id": 1
}

Respuesta esperada (200 OK):

{
  "id": 1,
  "name": "Rick Sanchez",
  "status": "Alive",
  "species": "Human",
  "gender": "Male",
  "ownedByUserId": 1,
  "forSale": false,
  "price": 0
}

Pruebas de validación:
	•	401 Unauthorized si no se incluye el token:

{
  "message": "Authentication token is missing or invalid"
}

409 Conflict
{
    "message": "Capture failed. Keep working to increase your chances!"
}

{
    "message": "Character already owned by user 1"
}
⸻

2.2 GET /characters/my-characters ✅

Endpoint:
GET http://localhost:5235/characters/my-characters

Headers:
Authorization: Bearer TU_TOKEN_AQUI

Respuesta esperada (200 OK):

[
  {
    "id": 1,
    "name": "Rick Sanchez",
    "status": "Alive",
    "species": "Human",
    "gender": "Male",
    "ownedByUserId": 1,
    "forSale": false,
    "price": 0
  },
  {
    "id": 2,
    "name": "Morty Smith",
    "status": "Alive",
    "species": "Human",
    "gender": "Male",
    "ownedByUserId": 1,
    "forSale": false,
    "price": 0
  }
]

Pruebas de validación:
	•	401 Unauthorized si no se incluye token.

⸻

2.3 GET /characters/{username} ✅

Endpoint:
GET http://localhost:5235/characters/testuser

Headers:
Authorization: Bearer TU_TOKEN_AQUI

Respuesta esperada (200 OK):

[
  {
    "id": 1,
    "name": "Rick Sanchez",
    "status": "Alive",
    "species": "Human",
    "gender": "Male",
    "ownedByUserId": 1,
    "forSale": false,
    "price": 0
  }
]

Pruebas de validación:
	•	404 Not Found si el usuario no existe.
{
    "message": "User not found"
}


⸻

2.4 GET /characters/for-sale ✅

Endpoint:
GET http://localhost:5235/characters/for-sale

Headers:
Authorization: Bearer TU_TOKEN_AQUI

Respuesta esperada (200 OK):

[
  {
    "id": 3,
    "name": "Birdperson",
    "status": "Dead",
    "species": "Alien",
    "gender": "Male",
    "ownedByUserId": 2,
    "forSale": true,
    "price": 500
  }
]


⸻

2.5 POST /characters/put-for-sale ✅

Endpoint:
POST http://localhost:5235/characters/put-for-sale

Headers:
Authorization: Bearer TU_TOKEN_AQUI
Content-Type: application/json

Body (JSON):

{
  "itemId": 1,
  "price": 100
}

Respuesta esperada (200 OK):

Character with ID 2 is now for sale at price 100.

Pruebas de validación:
	•	401 Unauthorized si no se incluye token.
	•	400 Bad Request si el personaje no pertenece al usuario.
{
    "message": "Character not found or you do not own this character."
}
409 Conflict
{
    "message": "Character is already for sale."
}
⸻

2.6 POST /characters/buy 

Endpoint:
POST http://localhost:5235/characters/buy

Headers:
Authorization: Bearer TU_TOKEN_AQUI
Content-Type: application/json

Body (JSON):

1

Donde 1 es el characterId que se quiere comprar.

Respuesta esperada (200 OK):

{
  "message": "Character purchased successfully",
  "characterId": 1,
  "buyerId": 1,
  "price": 100
}

Pruebas de validación:
	•	401 Unauthorized si no se incluye token.
	•	400 Bad Request si no hay suficiente dinero o el personaje no está a la venta.
        {
        "message": "Character not found or not for sale."
        }
    •   409 No puedes comprar tu propio character
        {
        "message": "You cannot buy your own character."
        }
 3️⃣ PRUEBAS DE EPISODES

Header común para endpoints protegidos:

Authorization: Bearer TU_TOKEN_AQUI
Content-Type: application/json

⸻

3.1 POST /episodes/capture ✅

Endpoint:
POST http://localhost:5235/episodes/capture

Headers:
Content-Type: application/json
Authorization: Bearer TU_TOKEN_AQUI

Body (JSON):
{
  "id": 1
}

Respuesta esperada (200 OK):
{
    "id": 2,
    "name": "Lawnmower Dog",
    "airDate": "2026-02-11",
    "episode": "S01E02",
    "characters": [
        "https://rickandmortyapi.com/api/character/1",
        "https://rickandmortyapi.com/api/character/2",
        "https://rickandmortyapi.com/api/character/38",
        "https://rickandmortyapi.com/api/character/46",
        "https://rickandmortyapi.com/api/character/63",
        "https://rickandmortyapi.com/api/character/80",
        "https://rickandmortyapi.com/api/character/175",
        "https://rickandmortyapi.com/api/character/221",
        "https://rickandmortyapi.com/api/character/239",
        "https://rickandmortyapi.com/api/character/246",
        "https://rickandmortyapi.com/api/character/304",
        "https://rickandmortyapi.com/api/character/305",
        "https://rickandmortyapi.com/api/character/306",
        "https://rickandmortyapi.com/api/character/329",
        "https://rickandmortyapi.com/api/character/338",
        "https://rickandmortyapi.com/api/character/396",
        "https://rickandmortyapi.com/api/character/397",
        "https://rickandmortyapi.com/api/character/398",
        "https://rickandmortyapi.com/api/character/405"
    ],
    "url": "https://rickandmortyapi.com/api/episode/2",
    "created": "2017-11-10T12:56:33.916Z",
    "forSale": false,
    "price": 0
}

Pruebas de validación:
401 Unauthorized si no se incluye token
409 Conflict si no se puede capturar
{
    "message": "Capture failed. Keep working to increase your chances!"
}
Mensaje si ya lo posee el usuario

⸻

3.2 GET /episodes/my-episodes ✅

Endpoint:
GET http://localhost:5235/episodes/my-episodes

Headers:
Authorization: Bearer TU_TOKEN_AQUI

Respuesta esperada (200 OK):
[
    {
        "id": 2,
        "name": "Lawnmower Dog",
        "airDate": "2026-02-11",
        "episode": "S01E02",
        "characters": [
            "https://rickandmortyapi.com/api/character/1",
            "https://rickandmortyapi.com/api/character/2",
            "https://rickandmortyapi.com/api/character/38",
            "https://rickandmortyapi.com/api/character/46",
            "https://rickandmortyapi.com/api/character/63",
            "https://rickandmortyapi.com/api/character/80",
            "https://rickandmortyapi.com/api/character/175",
            "https://rickandmortyapi.com/api/character/221",
            "https://rickandmortyapi.com/api/character/239",
            "https://rickandmortyapi.com/api/character/246",
            "https://rickandmortyapi.com/api/character/304",
            "https://rickandmortyapi.com/api/character/305",
            "https://rickandmortyapi.com/api/character/306",
            "https://rickandmortyapi.com/api/character/329",
            "https://rickandmortyapi.com/api/character/338",
            "https://rickandmortyapi.com/api/character/396",
            "https://rickandmortyapi.com/api/character/397",
            "https://rickandmortyapi.com/api/character/398",
            "https://rickandmortyapi.com/api/character/405"
        ],
        "url": "https://rickandmortyapi.com/api/episode/2",
        "created": "2017-11-10T12:56:33.916Z",
        "forSale": false,
        "price": 0
    }
]

Pruebas de validación:
401 Unauthorized si no se incluye token

⸻

3.3 GET /episodes/{username}

Endpoint:
GET http://localhost:5235/episodes/testuser

Headers:
Authorization: Bearer TU_TOKEN_AQUI

Respuesta esperada (200 OK):
[
    {
        "id": 2,
        "name": "Lawnmower Dog",
        "airDate": "2026-02-11",
        "episode": "S01E02",
        "characters": [
            "https://rickandmortyapi.com/api/character/1",
            "https://rickandmortyapi.com/api/character/2",
            "https://rickandmortyapi.com/api/character/38",
            "https://rickandmortyapi.com/api/character/46",
            "https://rickandmortyapi.com/api/character/63",
            "https://rickandmortyapi.com/api/character/80",
            "https://rickandmortyapi.com/api/character/175",
            "https://rickandmortyapi.com/api/character/221",
            "https://rickandmortyapi.com/api/character/239",
            "https://rickandmortyapi.com/api/character/246",
            "https://rickandmortyapi.com/api/character/304",
            "https://rickandmortyapi.com/api/character/305",
            "https://rickandmortyapi.com/api/character/306",
            "https://rickandmortyapi.com/api/character/329",
            "https://rickandmortyapi.com/api/character/338",
            "https://rickandmortyapi.com/api/character/396",
            "https://rickandmortyapi.com/api/character/397",
            "https://rickandmortyapi.com/api/character/398",
            "https://rickandmortyapi.com/api/character/405"
        ],
        "url": "https://rickandmortyapi.com/api/episode/2",
        "created": "2017-11-10T12:56:33.916Z",
        "forSale": false,
        "price": 0
    }
]

Pruebas de validación:
404 Not Found si el usuario no existe
{
    "message": "User not found"
}
⸻

3.4 GET /episodes/for-sale

Endpoint:
GET http://localhost:5235/episodes/for-sale

Headers:
Authorization: Bearer TU_TOKEN_AQUI

Respuesta esperada (200 OK):
[
  {
    "id": 2,
    "name": "Lawnmower Dog",
    "episodeCode": "S01E02",
    "airDate": "2013-12-09",
    "ownedByUserId": 2,
    "forSale": true,
    "price": 250
  }
]

⸻

3.5 POST /episodes/put-for-sale

Endpoint:
POST http://localhost:5235/episodes/put-for-sale

Headers:
Authorization: Bearer TU_TOKEN_AQUI
Content-Type: application/json

Body (JSON):
{
  "itemId": 1,
  "price": 100
}

Respuesta esperada (200 OK):
Episode with ID 1 is now for sale at price 100.

Pruebas de validación:
401 Unauthorized si no se incluye token
400 Bad Request si el episodio no pertenece al usuario
{
    "message": "Character not found or you do not own this character."
}
409 Conflict
{
    "message": "Episode is already for sale."
}
⸻

3.6 POST /episodes/buy

Endpoint:
POST http://localhost:5235/episodes/buy

Headers:
Authorization: Bearer TU_TOKEN_AQUI
Content-Type: application/json

Body (JSON):
1

Respuesta esperada (200 OK):
{
  "message": "Episode purchased successfully",
  "episodeId": 1,
  "buyerId": 1,
  "price": 100
}

Pruebas de validación:
401 Unauthorized si no se incluye token
400 Bad Request si no hay suficiente dinero o el episodio no está a la venta
409 No puedes comprar tu propio episodio
{
    "message": "Episode not found or not for sale."
}